<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Actual vs Variance Report - PDF</title>
    <style>
        /* Font */
        @font-face {
            font-family: 'QuickBooks';
            src: local('Arial'), local('Helvetica'), sans-serif;
        }
        body {
            font-family: 'QuickBooks', Arial, sans-serif;
            font-size: 10px;
            color: #333;
            margin: 0;
            padding: 0;
        }

        /* Page orientation landscape */
        @page {
            size: A4 landscape;
            margin: 15mm;
        }

        /* Header */
        header {
            text-align: center;
            padding: 8px 0;
            border-bottom: 2px solid #4CAF50;
            margin-bottom: 15px;
        }
        header h1 {
            margin: 0;
            font-size: 16px;
            color: #2E7D32;
        }

        /* Footer (after main content) */
        footer {
            text-align: center;
            font-size: 9px;
            color: #888;
            border-top: 1px solid #ccc;
            padding: 4px 0;
            margin-top: 20px;
        }

        /* Table */
        table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 4px;
            text-align: left; /* Left-align table content */
            font-size: 9.5px;
        }
        th {
            background-color: #f5f5f5;
            color: #333;
            font-weight: bold;
            text-align: left; /* Table headers left-aligned */
        }
        tbody tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        /* Variance coloring */
        .text-success {
            color: green;
            font-weight: bold;
        }
        .text-danger {
            color: red;
            font-weight: bold;
        }

        /* Page break if needed */
        .page-break {
            page-break-after: always;
        }

        /* Center main wrapper (header/footer) */
        .wrapper {
            width: 100%;
            text-align: center;
        }
    </style>
</head>
<body>

    <div class="wrapper">
        <header>
            <h1>Actual vs Variance Report</h1>
        </header>
    </div>

    <main>
        <table>
            <thead>
                <tr>
                    <th>Year</th>
                    <th>Project</th>
                    <th>Indicator</th>
                    <th>Unit</th>
                    <th>Cumulative Actual</th>
                    <th>Current Month Actual</th>
                    <th>Total Actual</th>
                    <th>Target (Annual)</th>
                    <th>Variance</th>
                    <th>Progress (%)</th>
                </tr>
            </thead>
            <tbody>
                {% for row in table_rows %}
                <tr>
                    <td>{{ row.year }}</td>
                    <td>{{ row.project }}</td>
                    <td>{{ row.indicator }}</td>
                    <td>{{ row.unit }}</td>
                    <td>{{ row.cumulative }}</td>
                    <td>{{ row.actual }}</td>
                    <td>{{ row.total_actual }}</td>
                    <td>{{ row.target }}</td>
                    <td class="{% if row.variance >= 0 %}text-success{% else %}text-danger{% endif %}">
                        {% if row.variance >= 0 %}✅{% else %}❌{% endif %} {{ row.variance }}
                    </td>
                    <td>{{ row.progress|floatformat:1 }}%</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="10" style="color:#888; font-style:italic;">No data available.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </main>

    <div class="wrapper">
        <footer>
            Generated by Life Concern Data Management System &copy; {{ year }}
        </footer>
    </div>

</body>
</html>
